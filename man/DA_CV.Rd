% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/da_cv.R
\name{DA_CV}
\alias{DA_CV}
\title{Dissimilarity-Adaptive Cross-Validation (DA-CV) RMSE}
\usage{
DA_CV(
  samples,
  predictors,
  response,
  folds_k = 5,
  autoc_threshold = 0.2,
  cate_num = 5,
  seed = NULL
)
}
\arguments{
\item{samples}{An \code{sf} object with point samples. Must include the response
variable and predictor variables as attributes.}

\item{predictors}{A \code{terra::rast} object containing predictor rasters
aligned to the study area.}

\item{response}{Name of the response column in \code{samples}.}

\item{folds_k}{Integer. Number of folds for cross-validation.}

\item{autoc_threshold}{Numeric. Spatial autocorrelation threshold for spatial+ CV.}

\item{cate_num}{Integer. Number of spatial clusters (used in spatial+ CV).}

\item{seed}{Optional integer. Random seed for reproducibility (passed to \code{set.seed()}).}
}
\value{
A list with components:
\describe{
\item{dissimilarity}{Dissimilarity index D; ranging from 0 to 1}
\item{threshold}{Threshold T(D) = D * 0.5}
\item{similarity_raster}{Similarity raster}
\item{category_raster}{Binarized similarity raster. 1 - Different, 2 - Similar}
\item{weights}{Relative weights of "similar" and "different" areas}
\item{folds_RDM}{folds from RDM-CV}
\item{folds_SP}{folds from SP-CV}
}
}
\description{
This function implements dissimilarity-adaptive cross-validation (DA-CV),
which combines random CV (RDM-CV) and spatial CV (SP-CV) based on
adversarial validation (AV). The method follows the framework described in
\href{https://doi.org/10.1016/j.ecoinf.2025.103287}{Wang et al., 2025}.
}
\details{
Steps:
\enumerate{
\item Generate adversarial validation dataset by combining sample points
with randomly sampled prediction locations from \code{predictors}.
\item Train a classifier (random forest) to distinguish samples from
prediction locations.
\item Evaluate classifier via AUC → dissimilarity index D.
\item Apply classifier to all raster cells → similarity map.
\item Threshold map at T(D) = D * 0.5 to classify cells into
\{similar, different\}.
\item Run RDM-CV on "similar" subset, spatial+ CV on "different" subset.
\item Combine RMSEs via weighted average by area proportion. (Needs to be done manually after running \code{DA_CV()})
}
}
\examples{
\dontrun{
library(sf)
library(terra)

# Sample points
pts <- st_as_sf(data.frame(
  x = runif(50, 0, 100),
  y = runif(50, 0, 100),
  yvar = rnorm(50)
), coords = c("x", "y"), crs = 32633)

# Predictor rasters
r <- rast(ncols=100, nrows=100, xmin=0, xmax=100, ymin=0, ymax=100)
values(r) <- runif(ncell(r))

# Run DA-CV (RDM_CV and spatial_plus_cv (must be available)
result <- DA_CV(
  samples = pts,
  predictors = r,
  response = "yvar",
  folds_k = 5,
  autoc_threshold = 0.2,
  cate_num = 5
)
print(result$RMSE)
}

}
